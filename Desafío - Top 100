ğŸ˜Šï¸ğŸ˜Šï¸ğŸ˜Šï¸DESAFÃO - TOP 100

ğŸ˜Šï¸ğŸ˜Šï¸INSTRUCCIONES


ğŸ˜Šï¸ 1. CREAR BASE DE DATOS LLAMADA PELÃCULAS (1 PUNTO)

TRubilarP=# CREATE DATABASE pelÃ­culas;
CREATE DATABASE
TRubilarP=# \c pelÃ­culas;
You are now connected to database "pelÃ­culas" as user "TRubilarP".
pelÃ­culas=# 


ğŸ˜Šï¸ 2. REVISAR LOS ARCHIVOS PELICULAS.CSV Y REPARTO.CSV PARA CREAR LAS TABLAS CORRESPONDIENTES,
DETERMINANDO LA RELACIÃ“N ENTRE AMBAS TABLAS. (2 PUNTOS)


pelÃ­culas=# CREATE TABLE Cinema(
pelÃ­culas(# id INT,
pelÃ­culas(# PelÃ­cula VARCHAR(150),
pelÃ­culas(# AÃ±o_Estreno VARCHAR(10),
pelÃ­culas(# Director VARCHAR(150),
pelÃ­culas(# PRIMARY KEY(id)
pelÃ­culas(# );
CREATE TABLE

pelÃ­culas=# SELECT * FROM Cinema;

 id | pelÃ­cula | aÃ±o_estreno | director 
----+----------+-------------+----------
(0 rows)


pelÃ­culas=# CREATE TABLE starring(
pelÃ­culas(# id INT,
pelÃ­culas(# Protagonistas VARCHAR(100),
pelÃ­culas(# FOREIGN KEY (id) REFERENCES Cinema (id)
pelÃ­culas(# );
CREATE TABLE
pelÃ­culas=# 

pelÃ­culas=# SELECT * FROM starring;
 id | protagonistas 
----+---------------
(0 rows)


ğŸ˜Šï¸ 3. CARGAR AMBOS ARCHIVOS A SU TABLA CORRESPONDIENTE (1 PUNTO)

pelÃ­culas=# \copy Cinema FROM 'Escritorio/top100/peliculas.csv' csv header;
COPY 100
pelÃ­culas=# 

pelÃ­culas=# \copy starring FROM 'Escritorio/top100/reparto.csv' csv;
COPY 1051
pelÃ­culas=# 


ğŸ˜Šï¸ 4. LISTAR TODOS LOS ACTORES QUE APARECEN EN LA PELÃCULA "TITANIC", INDICANDO EL TÃTULO DE LA PELÃCULA,
AÃ‘O DE ESTRENO, DIRECTOR Y TODO EL REPARTO. (0.5 PUNTOS)

pelÃ­culas=# SELECT pelÃ­cula, aÃ±o_estreno, director, protagonistas FROM Cinema JOIN starring ON Cinema.id=starring.id WHERE Cinema.pelÃ­cula='Titanic';

 pelÃ­cula | aÃ±o_estreno |   director    |   protagonistas   
----------+-------------+---------------+-------------------
 Titanic  |        1997 | James Cameron | Leonardo DiCaprio
 Titanic  |        1997 | James Cameron | Kate Winslet
 Titanic  |        1997 | James Cameron | Billy Zane
 Titanic  |        1997 | James Cameron | Kathy Bates
 Titanic  |        1997 | James Cameron | Frances Fisher
 Titanic  |        1997 | James Cameron | Bernard Hill
 Titanic  |        1997 | James Cameron | Jonathan Hyde
 Titanic  |        1997 | James Cameron | Danny Nucci
 Titanic  |        1997 | James Cameron | David Warner
 Titanic  |        1997 | James Cameron | Bill Paxton
 Titanic  |        1997 | James Cameron | Gloria Stuart
 Titanic  |        1997 | James Cameron | Victor Garber
 Titanic  |        1997 | James Cameron | Suzy Amis
(13 rows)



ğŸ˜Šï¸ 5. LISTAR LOS TITULOS DE LAS PELÃCULAS DONDE ACTÃšE HARRISON FORD.(0.5 PUNTOS)

pelÃ­culas=# SELECT pelÃ­cula FROM Cinema JOIN starring ON Cinema.id=starring.id WHERE starring.protagonistas='Harrison Ford';
                   pelÃ­cula                    
-----------------------------------------------
 Star Wars. Episodio IV: Una nueva esperanza
 Indiana Jones y la Ãºltima cruzada
 En busca del arca perdida
 Star Wars. Episodio V: El imperio contraataca
 Star Wars. Episodio VI: El retorno del Jedi
 Blade Runner
 Apocalypse Now
 Indiana Jones y el templo maldito
(8 rows)


ğŸ˜Šï¸ 6. LISTAR LOS 10 DIRECTORES MAS POPULARES, INDICANDO SU NOMBRE Y CUÃNTAS PELÃCULAS APARECEN EN EL
TOP 100.(1 PUNTOS)


pelÃ­culas=# SELECT director,count(*) FROM Cinema GROUP BY director ORDER BY count(*) DESC LIMIT 10;

       director       | count 
----------------------+-------
 Steven Spielberg     |     9
 Francis Ford Coppola |     4
 Peter Jackson        |     4
 Quentin Tarantino    |     3
 Martin Scorsese      |     3
 Robert Zemeckis      |     3
 James Cameron        |     3
 Ridley Scott         |     3
 George Lucas         |     3
 Frank Darabont       |     2
(10 rows)


ğŸ˜Šï¸ 7. INDICAR CUANTOS ACTORES DISTINTOS HAY (1 PUNTOS)

** ESTA QUERY ENTREGA EL NOMBRE DE LOS 831 ACTORES DISTINTOS
pelÃ­culas=# SELECT DISTINCT protagonistas FROM starring;
(831 rows)


** ESTA QUERY SOLO LOS CUENTA
pelÃ­culas=# SELECT count (DISTINCT protagonistas) FROM starring; 
 count 
-------
   831
(1 row)


ğŸ˜Šï¸ 8. INDICAR LAS PELÃCULAS ESTRENADAS ENTRE LOS AÃ‘OS 1990 Y 1999 (AMBOS INCLUIDOS) ORDENADAS POR
TÃTULO DE MANERA ASCENDENTE.(1 PUNTO)


** AQUÃ TUVE QUE ACTUALIZAR LA COLUMNA AÃ‘O_ESTRENO, PORQUE INICIALMENTE LA HICE CON UN TIPO DE DATO VARCHAR Y AHORA NECESITO INT (NO PUDE HACERLO CON VARCHAR, ES POR ELLO QUE CAMBIÃ‰ A INT)

pelÃ­culas=# ALTER TABLE Cinema ALTER COLUMN AÃ±o_Estreno TYPE INT USING AÃ±o_Estreno::integer;
ALTER TABLE
pelÃ­culas=#

pelÃ­culas=# SELECT pelÃ­cula, aÃ±o_estreno FROM Cinema WHERE aÃ±o_estreno >= 1990 AND aÃ±o_estreno <= 1999 ORDER BY aÃ±o_estreno;

                  pelÃ­cula                  | aÃ±o_estreno 
--------------------------------------------+-------------
 Uno de los nuestros                        |        1990
 Eduardo Manostijeras                       |        1990
 El Padrino. Parte III                      |        1990
 Terminator 2: el juicio final              |        1991
 El silencio de los corderos                |        1991
 La lista de Schindler                      |        1993
 Parque JurÃ¡sico                            |        1993
 Pesadilla antes de navidad                 |        1993
 Forest Gump                                |        1994
 Cadena perpetua                            |        1994
 Pulp Fiction                               |        1994
 Entrevista con el vampiro                  |        1994
 El profesional                             |        1994
 Seven                                      |        1995
 Toy Story                                  |        1995
 Braveheart                                 |        1995
 Trainspotting                              |        1996
 Titanic                                    |        1997
 Hombres de negro                           |        1997
 Mejor... imposible                         |        1997
 American History X                         |        1998
 Salvar al soldado Ryan                     |        1998
 El show de Truman                          |        1998
 Toy Story 2                                |        1999
 La milla verde                             |        1999
 American Beauty                            |        1999
 Matrix                                     |        1999
 Star Wars. Episodio I: La amenaza fantasma |        1999
 El sexto sentido                           |        1999
 El club de la pelea                        |        1999
(30 rows)


ğŸ˜Šï¸ 9. LISTAR EL REPARTO DE LAS PELÃCULAS LANZADAS EL AÃ‘O 2001 (1 PUNTO)

pelÃ­culas=# SELECT protagonistas, pelÃ­cula, aÃ±o_estreno FROM cinema JOIN starring ON cinema.id=starring.id WHERE aÃ±o_estreno=2001;

protagonistas   |                     pelÃ­cula                     | aÃ±o_estreno 
-------------------+--------------------------------------------------+-------------
 Elijah Wood       | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Ian McKellen      | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Viggo Mortensen   | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Sean Astin        | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Sean Bean         | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Cate Blanchett    | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Hugo Weaving      | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Liv Tyler         | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Ian Holm          | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Christopher Lee   | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 John Rhys-Davies  | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Orlando Bloom     | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Dominic Monaghan  | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Billy Boyd        | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Lawrence Makoare  | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Craig Parker      | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Marton Csokas     | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Andy Serkis       | El SeÃ±or de los anillos: La comunidad del anillo |        2001
 Animada           | Monstruos S.A.                                   |        2001
 Animada           | El viaje de Chihiro                              |        2001
 Audrey Tautou     | AmÃ©lie                                           |        2001
 Mathieu Kassovitz | AmÃ©lie                                           |        2001
 Rufus             | AmÃ©lie                                           |        2001
 Lorella Cravotta  | AmÃ©lie                                           |        2001
 Serge Merlin      | AmÃ©lie                                           |        2001
 Jamel Debbouze    | AmÃ©lie                                           |        2001
 Claire Maurier    | AmÃ©lie                                           |        2001
 Clotilde Mollet   | AmÃ©lie                                           |        2001
 Isabelle Nanty    | AmÃ©lie                                           |        2001
 Dominique Pinon   | AmÃ©lie                                           |        2001
 Artus de Penguern | AmÃ©lie                                           |        2001
 Yolande Moreau    | AmÃ©lie                                           |        2001
 Urbain Cancelier  | AmÃ©lie                                           |        2001
 Maurice Benichou  | AmÃ©lie                                           |        2001
 George Clooney    | Ocean's Eleven                                   |        2001
 Julia Roberts     | Ocean's Eleven                                   |        2001
 Matt Damon        | Ocean's Eleven                                   |        2001
 Andy GarcÃ­a       | Ocean's Eleven                                   |        2001
 Brad Pitt         | Ocean's Eleven                                   |        2001
 Casey Affleck     | Ocean's Eleven                                   |        2001
 Scott Caan        | Ocean's Eleven                                   |        2001
 Elliott Gould     | Ocean's Eleven                                   |        2001
 Bernie Mac        | Ocean's Eleven                                   |        2001
 Carl Reiner       | Ocean's Eleven                                   |        2001
 Don Cheadle       | Ocean's Eleven                                   |        2001
 Topher Grace      | Ocean's Eleven                                   |        2001
 Joshua Jackson    | Ocean's Eleven                                   |        2001
 Holly Marie Combs | Ocean's Eleven                                   |        2001
 Shane West        | Ocean's Eleven                                   |        2001
 Nicole Kidman     | Mouling Rouge                                    |        2001
 Ewan McGregor     | Mouling Rouge                                    |        2001
 John Leguizamo    | Mouling Rouge                                    |        2001
 Jim Broadbent     | Mouling Rouge                                    |        2001
 Richard Roxburgh  | Mouling Rouge                                    |        2001
 David Wenham      | Mouling Rouge                                    |        2001
 Jacek Koman       | Mouling Rouge                                    |        2001
 Kylie Minogue     | Mouling Rouge                                    |        2001
(57 rows)


ğŸ˜Šï¸ 10. LISTAR LOS ACTORES DE LA PELÃCULA MÃS NUEVA (1 PUNTO)

** QUERY 1: SOLO LISTA LOS ACTORES DE LA PELÃCULA MÃS NUEVA

pelÃ­culas=# SELECT protagonistas FROM Cinema JOIN starring ON Cinema.id=starring.id WHERE aÃ±o_estreno=(SELECT MAX(aÃ±o_estreno) FROM Cinema);
    protagonistas     
----------------------
 Christian Bale
 Heath Ledger
 Aaron Eckhart
 Michael Caine
 Gary Oldman
 Maggie Gyllenhaal
 Morgan Freeman
 Eric Roberts
 Cillian Murphy
 Anthony Michael Hall
 Michael Jai White
 William Fichtner
 Edison Chen
 Monique Curnen
 Chin Han
 Nestor Carbonell
 Ritchie Coster
 Keith Szarabajka
 Colin McFarlane
 Melinda McGraw
 Nathan Gamble
 Michael Vieau
 Animada
 Robert Downey Jr.
 Terrence Howard
 Gwyneth Paltrow
 Jeff Bridges
 Stan Lee
 Leslie Bibb
 Clark Gregg
 Shaun Toub
 Faran Tahir
 Samuel L. Jackson
(33 rows)


** QUERY 2: ESTA QUERY LANZA PROTAGONISTA, PELÃCULA Y AÃ‘O DE ESTRENO DE LAS PELÃCULAS MÃS NUEVAS.

pelÃ­culas=# SELECT protagonistas, pelÃ­cula, aÃ±o_estreno FROM Cinema JOIN starring ON Cinema.id=starring.id WHERE aÃ±o_estreno=(SELECT MAX(aÃ±o_estreno) FROM Cinema);

    protagonistas     |      pelÃ­cula       | aÃ±o_estreno 
----------------------+---------------------+-------------
 Christian Bale       | El caballero oscuro | 2008
 Heath Ledger         | El caballero oscuro | 2008
 Aaron Eckhart        | El caballero oscuro | 2008
 Michael Caine        | El caballero oscuro | 2008
 Gary Oldman          | El caballero oscuro | 2008
 Maggie Gyllenhaal    | El caballero oscuro | 2008
 Morgan Freeman       | El caballero oscuro | 2008
 Eric Roberts         | El caballero oscuro | 2008
 Cillian Murphy       | El caballero oscuro | 2008
 Anthony Michael Hall | El caballero oscuro | 2008
 Michael Jai White    | El caballero oscuro | 2008
 William Fichtner     | El caballero oscuro | 2008
 Edison Chen          | El caballero oscuro | 2008
 Monique Curnen       | El caballero oscuro | 2008
 Chin Han             | El caballero oscuro | 2008
 Nestor Carbonell     | El caballero oscuro | 2008
 Ritchie Coster       | El caballero oscuro | 2008
 Keith Szarabajka     | El caballero oscuro | 2008
 Colin McFarlane      | El caballero oscuro | 2008
 Melinda McGraw       | El caballero oscuro | 2008
 Nathan Gamble        | El caballero oscuro | 2008
 Michael Vieau        | El caballero oscuro | 2008
 Animada              | Wall-E              | 2008
 Robert Downey Jr.    | Iron Man            | 2008
 Terrence Howard      | Iron Man            | 2008
 Gwyneth Paltrow      | Iron Man            | 2008
 Jeff Bridges         | Iron Man            | 2008
 Stan Lee             | Iron Man            | 2008
 Leslie Bibb          | Iron Man            | 2008
 Clark Gregg          | Iron Man            | 2008
 Shaun Toub           | Iron Man            | 2008
 Faran Tahir          | Iron Man            | 2008
 Samuel L. Jackson    | Iron Man            | 2008
(33 rows)



PARA LA REALIZACIÃ“N DE ESTE DESAFÃO SE DEBEN DESCARGAR LOS SIGUIENTES ARCHIVOS, QUE SE ECUENTRAN EN
PLATAFORMA EN EL ARCHIVO ZIP LLAMADO APOYO DESAFÃO

PELICULAS.CSV
REPARTO.CSV
